# abstract
비디오 이상 감지는 주어진 비디오에 비정상적인 이벤트, 동작 또는 개체가 있는지 여부를 확인하는 것으로,
이를 통해 효과적이고 지능적인 공공 안전 관리를 가능하게 한다.
비디오 이상 레이블링은 시간과 비용이 많이 들기 때문에 대부분의 기존 작업은 비지도 또는 약한 지도 학습 방법을 사용한다.
이 논문은 WVAD에 초점을 맞추는데, 여기서 훈련 비디오는 변칙이 포함되어 있는지 여부에 관계없이 레이블이 지정되지만 
변칙의 특정 프레임과 수량에 대한 정보는 부족하다.
그러나 레이블이 약하게 레이블이 지정된 데이터의 불확실성과 큰 모델 크기로 인해 기존 방법은 실제 시나리오,
특히 엣지 컴퓨팅과 같은 리소스 제한 상황에서 광범위하게 배포되지 않았다.
경량 비디오 이상 탐지 모델을 개발한다.
한편으로는, 모델의 현재 상태를 기반으로 하여 신뢰할 수 있는 인스턴스를 선택하는 적응형 인스턴스 선택 전략을 제안하며, 
이를 통해 약하게 레이블링된 데이터의 불확실성을 완화하고 결과적으로 모델의 성능을 향상시킨다.
다른 한편으로는, 모델을 구성하기 우해 경량 다단계 시간 상관 어텐션 모듈과 모래시계 모양의 완전 연결 계층을 설계

# Introduction
감시는 교통 모니터링 및 공공 안전 관리와 같은 많은 시나리오에서 예기치 않거나 비정상적인 이벤트를 식별하기 위한 중요한 도구 역할을 한다.
전통적으로 비디오 감시는 수동 조작과 낮은 지능에 크게 의존한다.
일반적으로 비디오 이상 탐지에는 감독, 비지도 및 약한 감독 유형이 있다.
지도 비디오 이상 감지에는 일반적으로 프레임 수준 또는 픽셀 수준 레이블이 필요함. -> 비싼 코스트
비지도 비디오 이상 감지는 레이블이 지정되지 않은 데이터를 사용하여 가장 낮은 훈련 비용으로 모델을 훈련시키지만 성능이 떨어진다.
WVAD는 약한 레이블이 지정된 데이터를 사용하여 모델을 훈련시키며, 여기서 훈련 비디오에는 이상이 포함되어 있는지 여부에 관계없이
레이블이 지정되지만 이상이 있는 프레임에 대한 정보는 없다.
따라서 WVAD는 지도 및 비지도 방법의 장점을 상속한다. 
WVAD는 일반적으로 MIL 프레임워크에서 구현된다.
학습 비디오는 이상이 있는 정확한 클립 및 프레임을 지정하지 않고 이상이 포함된 비디오를 나타낸다.
첫 번째느 약하게 레이블이 지정된 데이터의 불확실성, 즉 각 변칙 비디오 내에서 변칙 클립의 수와 위치에 대한 특정 정보가 부족하여 훈련
데이터의 효과적인 활용을 제한하고 결과적으로 만족스럽지 못한 성능으로 이어지는 것과 관련이 있다.
두 번째는 모델의 규모가 크고, 위에서 언급한 바와 같이 기존 방법의 과도한 매개변수 수와 관련이 있다.
구체적으로, 기존의 MIL 기반 방법은 훈련 세트에서 변칙 비디오의 수와 일반 비디오의 수 사이의 균형을 유지하기 위해 전략을 채택하고
가장 높은 변칙 점수의 인스턴스를 선택하여 손실을 계산한다.
이 전략은 레이블이 약하게 지정된 데이터의 불확실성을 최소화하는 것을 목표로 한다.
일반적으로 실제 시나리오에서 훈련에 사용되는 변칙 비디오의 지속 시간은 일반적으로 30초를 초과하며, 이는 여러 변칙 클립이 있음을 시사한다.
그러나 변칙 점수가 가장 높은 인스턴스만 선택하면 사용 가능한 모든 변칙 데이터의 사용률이 떨어질 수 있다.
RTFM의 통계적 발견에 따르면 변칙 비디오 내의 변칙 클립의 평균 개수는 대략 3개이다.
따라서 훈련 중인 모델의 현재 상태에 따라 적응적으로 정상 또는 변칙 인스턴스의 수를 선택하여 다양한 훈련 데이터셋을 수용할 수 있는 AIS 전략을 제안한다.

-> 기존 방식의 한계
일반적인 MIL 방식에서는 가장 큰 feature magnitude를 가진 3개의 클립을 선택하여 학습
즉, 이상 비디오와 정상 비디오 각각에서 가장 강한 특징을 가지는 클립 3개를 선택하여 손실 계산
어떤 데이터셋에서는 3개가 적절하지만, 어떤 데이터셋에서는 5개, 10개가 필요할 수도 있음.
데이터셋마다 최적의 클립개수가 다를 수 있는데, 이를 고정된 값으로 정하는 것은 한계가 있음.

반면에, 문헌에는 VAD를 위한 경량 모드 엘이 상대적으로 적으며, 일반적으로 더 작은 모델을 수용하기 위해 성능을 저하시킨다.
이 논문에서는 가벼우면서도 성능이 뛰어난 변칙 탐지 모델을 고안하기 위해 경량 MTA모듈을 사용한다.
이 모듈은 서로 다른 시간 범위의 자세에서 비디오 간의 관계를 강조하여 모델이 비디오의 중요한 인스턴스에 초점을 맞추도록 한다.
또한 모래 시계 모양의 HFC의 파라미터의 절반만 포함하지만 모델의 성능을 저하시키지 않는다.
마지막으로, 기존 방법에서 널리 사용되는 희소성 손실의 한계를 관찰하여, 보다 효과적인 길항 손실을 구체적으로 소개한다.

요약하면 
1) 먼저 I3D를 사용하여 각 비디오를 32개의 연속 클립으로 분해하고, 이 클립은 포지티브 또는 네거티브 인스턴스 백으로 인코딩 구성
백의 인스턴스는 MTA모듈에 입력되어 모델이 비디오의 시간 차원에서 중요한 기능에 초점을 맞추도록 한다.
2) 인스턴스 피처를 모래시계 모양의 HFC 계층에 입력하여 각 인스턴스에 대한 이상 점수를 얻는다.
3) 마지막으로 우리는 적응형 ins를 기반으로 손실 계산에 사용되는 양수 및 음수 인스턴스의 수 K를 역동적으로 결정한다.

# related work

2.1 WVAD
기존의 변칙 탐지 방법은 일반적으로 일반 훈련 데이터만 사용할 수 있다고 가정하고 문제를 해결하기 위해 단일 클래스 분류를 우해 직접 제작한 기능을 사용
딥러닝 기술의 개발로 일부 비지도 학습 방법은 심층 신경망을 활용하여 인간의 자세 및 광학 흐름과 같은 기능을 학습하거나, 정상 샘플과 비정상 샘플 간의 특징 분포 차이를 활용하여
비정상 감지를 수행한다. 비지도 비디오 이상 감지 방법의 핵심은 이상이 드문 이벤트라는 가정이 있으며, 따라서 모델은 주로 정상 샘플의 특징 분포를 학습하도록 훈련된다.
이 가정에 따라 모델은 테스트 샘플과 정상 샘플의 재구성 오류 또는 기능 분포를 계산하여 테스트 샘플이 변칙인지 여부를 결정한다.
그러나 변칙에 대한 사전 지식이 부족하기 때문에 이러한 방법은 학습 데이터에 과적합되기 수비고 정상 이벤트와 비정상 이벤트를 구별할 수 없다.
일부 연구는 부분적으로 라벨링된 비정상 샘플을 사용하는 것이 비지도 방법보다 더 나은 성능을 달성할 수 있음을 보여주었다.
그러나 많은 수의 프레임 수준 레이블을 얻는 데 드는 비용은 엄청나게 높다.
따라서 일부 비디오 이상 감지 방법은 약한 지도 훈련을 위해 비디오 수준 레이블을 사용하는 방법을 제안한다.
훈련 중 손실 계산을 위해 양수 및 음수 백 모두에서 가장 높은 변칙 예측 점수의 인스턴스를 사용하므로 훈련 데이터의 활용도가 떨어진다.
이 문제를 해결하기 위해 GCN을 사용하여 레이블 노이즈를 제거하여 데이터 활용도와 모델 성능을 향상시켰다.
이 방법을 사용하면 모델 성능이 향상되지만 GCN 및 MIL과 관련된 학습 계산 비용이 상당히 높다. 
또한 기능 공간에서 기능이 제한되지 않아 성능이 불안정해질 수 있다. 
RTFM 학습을 고안하여 표현 학습과 변칙 점수 학습을 통합했다.
그들은 손실 계산을 위해 비정상 및 정상 백 모두에서 가장 큰 특징 크기를 가진 세 개의 인스턴스를 별도로 선택했다. 
이러한 접근 방식은 학습 데이터를 효과적으로 활용하여 더 나은 성능을 얻을 수 있다.
그러나 이 학습 데이터 활용 전략은 서로 다른 데이터 세트의 다양한 특성을 고려하지 않는다.
큰 모델 매개변수의 문제를 해결하기 위해 기업에서 성능 향상을 위해 비교주의 모듈을 사용하는 경량 MIL 모델을 
제안했다.
BE-WVAD는 짧은 입력 추론 모드를 도입하여 필요한 입력 비디오 길이를 크게 줄여 메모리 및 계산 비용을 낮춘다.
위의 작업은 큰 모델 매개변수로 인해 제기되는 문제를 효과적으로 해결하는 동시에 실제 응용 프로그램에서 모델의 성능과 



















